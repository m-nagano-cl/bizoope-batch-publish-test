# 連携ファイル取込み時のカスタムフォーマッター

`schema/interface_files/udf/{SITE ID}/{file_type}.js`が存在する場合、連携ファイルをBigQueryワークテーブルにロードする際にユーザー定義処理が適用されます。

標準フォーマットで連携ファイルを受信する場合には必要ありません。標準フォーマットが使えない連携元（既存顧客など）のための処置です。

[UDFの仕様などはこちら](../../../../dataflow/text_to_bigquery/README.md#カスタムフォーマッターUDFについて)

## カスタムフォーマッター作成手順

このフォルダ (`udf`) 直下にサイト名のフォルダを作成します。そのサイトフォルダ直下に`[連携ファイル種別].js`のファイルを作成し変換処理を記載します。

前述「UDFの仕様などについて」を参考にフォーマット関数を作成してください。実際にDataflowから呼び出されるフォーマット関数とは別に`test`関数を作成してください。`test`関数では、フォーカット関数を呼び出し期待する結果と一致すれば`true`、異なれば`false`を返してください。実行の仕方などは「[Java上でのテスト](../../../../tools/test_dataflow_udf/README.md)」を参考にしてください。簡易的なテストなのであまり気の利いたレポートは出ないですが、UDFをゴリゴリ作るつもりもないのでこれくらいで…
